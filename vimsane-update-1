#!/bin/bash
# vimsane-update-1
#
# Updates a user's configuration to vimsane v1
#
# Prerequisite:  the ~/.vimsane directory must exist 
#
# Args:  
#      $1: version currently installed [ '0' if not previously installed ]
#      $2: target version.  Must be >= ThisVersion.

source ${VimsaneCodeRoot}/vs_constants
ThisVersion=1

function errExit { 
   echo  "ERROR: $*" >&2
   exit 1
}

function safeToInitVimrc {
    if [[ -f ~/.vimrc ]] || [[ -h ~/.vimrc ]]; then  
        prompt_flow "
        ERROR: I found a file or symlink named '~/.vimrc' -- this is not allowed.  If you want to keep it, do this:

        1. Rename your ~/.vimrc to something else. 
        2. Restart the vimsane installation
        3. Edit the new ~/.vim/vimrc that vimsane will create, and add your stuff to the end of it.

        If you don't want to keep it, delete it and start over.
        "
        false
        return
    fi
    if cd $HOME/.vim 2>/dev/null; then
        prompt_flow "
        ERROR: I found a directory named '~/.vim' -- this is not allowed.  If you want to keep it:

        1. Rename ~/.vim to something else.
        2. Restart the vimsane installation
        3. Merge your stuff manually into the ~/.vim directory that vimsane creates.

        If you don't want to keep your ~/.vim dir and its contents, delete it and start over (e.g. with 'rm -rf ~/.vim')
        "
        false
        return
    fi
    true
}

if [[ -z $sourceMe ]]; then
    if ! safeToInitVimrc; then
        exit 1
    fi
    echo "Update to v$ThisVersion is complete."
    true
fi
# vim: filetype=sh formatoptions=ocr :
#
